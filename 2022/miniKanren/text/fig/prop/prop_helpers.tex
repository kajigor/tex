\begin{figure*}[!t]
  \centering
  \begin{minipage}{\textwidth}
    \begin{lstlisting}[label={prop_helpers}, caption={Functions used in logic formulas generation}, captionpos=b, frame=tb]
andR :: Bool -> Stream (Bool, Bool)
andR result =
  if result
  then
    return (True, True)
  else
    return (True, False) `mplus`
    return (False, True) `mplus`
    return (False, False)

orR :: Bool -> Stream (Bool, Bool)
orR result =
  if result
  then
    return (True, False) `mplus`
    return (True, True) `mplus`
    return (False, True)
  else
    return (False, False)

notR :: Bool -> Stream Bool
notR result =
  if result
  then return False
  else return True

elemR :: Bool -> Int -> Stream (Int, [Bool])
elemR _ maxListLength | maxListLength <= 0 = Empty
elemR result maxListLength =
     zero result `mplus` succ result
  where
    zero result  =
      fromList [ (0, result : tl) | tl <- genList genBool (maxListLength - 1) ]
    succ result = do
      (n', t) <- elemR result (maxListLength - 1)
      fromList [(n' + 1, h : t) | h <- genBool ]
    \end{lstlisting}
  \end{minipage}
\end{figure*}


