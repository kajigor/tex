\appendix

\section{Principal Directions of the Addition Relation}

\begin{figure}[!t]
  \centering
  \begin{minipage}{\columnwidth}
    \begin{lstlisting}[label={add_all}, caption={Function for \lstinline{addo out out out} direction}, captionpos=b, frame=tb]
add :: Stream (Nat, Nat, Nat)
add =
    disj1 `mplus` disj2
  where
    disj1 = do
      z <- genNat
      return (O, z, z)
    disj2 = do
      (x', y, z') <- add
      return (S x', y, S z')
    \end{lstlisting}
  \end{minipage}
\end{figure}

\begin{figure}[!t]
  \centering
  \begin{minipage}{\columnwidth}
    \begin{lstlisting}[label={add_y}, caption={Function for \lstinline{addo out in out} direction}, captionpos=b, frame=tb]
addY :: Nat -> Stream (Nat, Nat)
addY y =
  return (O, y) `mplus`
  do
    (x', z') <- addY y
    return (S x', S z')
    \end{lstlisting}
  \end{minipage}
\end{figure}

\begin{figure}[!t]
  \centering
  \begin{minipage}{\columnwidth}
    \begin{lstlisting}[label={add_x_z}, caption={Function for \lstinline{addo in out in} direction}, captionpos=b, frame=tb]
addXZ :: Nat -> Nat -> Stream Nat
addXZ x z =
  case x of
    O -> return z
    S x' ->
      case z of
        O -> Empty
        S z' ->
          addXZ x' z'
    \end{lstlisting}
  \end{minipage}
\end{figure}

\begin{figure}[!t]
  \centering
  \begin{minipage}{\columnwidth}
    \begin{lstlisting}[label={add_y_z}, caption={Function for \lstinline{addo out in in} direction}, captionpos=b, frame=tb]
addYZ :: Nat -> Nat -> Stream Nat
addYZ y z =
  if y == z
  then return O
  else
    case z of
      S z' -> do
        x <- addYZ y z'
        return (S x)
      O -> Empty
    \end{lstlisting}
  \end{minipage}
\end{figure}